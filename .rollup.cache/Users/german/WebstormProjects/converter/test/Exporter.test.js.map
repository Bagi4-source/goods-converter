{"version":3,"file":"Exporter.test.js","sourceRoot":"","sources":["Exporter.test.ts"],"names":[],"mappings":"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","sourcesContent":["import {describe, it} from \"node:test\";\nimport {Exporter, Formatters, YMLFormatter, Transformer} from \"../src\";\nimport {Category, Currency, Product, Vat} from \"../src/types\";\nimport {expect} from \"chai\";\n\n\ndescribe('Exporter', () => {\n    const exporter = new Exporter();\n    const products: Product[] = [\n        {\n            productId: 1,\n            parentId: 0,\n            variantId: 1111,\n            currency: Currency.RUR,\n            title: \"Title\",\n            description: \"Description\",\n            vendor: \"Nike\",\n            vendorCode: \"NIKE-1111\",\n            categoryId: 1,\n            countryOfOrigin: \"Китай\",\n            images: [\"image1\", \"image2\"],\n            price: 19000,\n            oldPrice: 20000,\n            additionalExpenses: 1000,\n            purchasePrice: 15000,\n            available: true,\n            barcode: \"567890567893\",\n            weight: 0.15,\n            dimensions: \"12/32/43\",\n            vat: Vat.VAT_20,\n            count: 24,\n            params: [{\n                key: \"p1\",\n                value: \"v1\"\n            }, {\n                key: \"p2\",\n                value: \"v2\"\n            }],\n            age: {\n                unit: \"year\",\n                value: 6\n            },\n            tags: [\"Nike\", \"Кроссовки\"],\n            adult: false\n        }\n    ];\n    const categories: Category[] = [\n        {id: 1, parentId: 2, name: \"Обувь\"},\n        {id: 2, parentId: 3, name: \"Одежда, обувь и аксессуары\"},\n        {id: 3, name: \"Все товары\"},\n    ];\n\n    it('should check if all formatters implement the Formatter interface', async () => {\n        const Transformers: Record<string, Transformer> = {\n            PRICE: (product) => ({\n                ...product,\n                price: product.price + 10000\n            }),\n            IMAGE: (product) => ({\n                ...product,\n                images: product.images?.map(image => image.replace(\"image\", \"pic\"))\n            })\n        }\n\n        const keys = [\"PRICE\", \"IMAGE\"]\n\n        exporter.setFormatter(Formatters.YML);\n        exporter.setTransformers(keys.map(key => Transformers[key]));\n\n        const result = await exporter.export(products, categories);\n        const date = new Date().toISOString().replace(/.\\d+Z/, '');\n        const expectedResult = `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><yml_catalog date=\"${date}\"><shop><name>ShopName</name><company>CompanyName</company><categories><category id=\"1\" parentId=\"2\">Обувь</category><category id=\"2\" parentId=\"3\">Одежда, обувь и аксессуары</category><category id=\"3\">Все товары</category></categories><offers><offer id=\"1111\"><name>Title</name><price>29000</price><oldprice>20000</oldprice><purchase_price>15000</purchase_price><additional_expenses>1000</additional_expenses><currencyId>RUR</currencyId><categoryId>1</categoryId><vendor>Nike</vendor><vendorCode>NIKE-1111</vendorCode><picture>pic1</picture><picture>pic2</picture><available>true</available><param name=\"p1\">v1</param><param name=\"p2\">v2</param><description><![CDATA[Description]]></description><country_of_origin>Китай</country_of_origin><barcode>567890567893</barcode><vat>VAT_20</vat><count>24</count><set-ids>Nike, Кроссовки</set-ids><adult>false</adult><weight>0.15</weight><dimensions>12/32/43</dimensions><age unit=\"year\">6</age></offer></offers></shop></yml_catalog>`;\n        expect(result).to.deep.equal(expectedResult);\n    });\n});\n"]}